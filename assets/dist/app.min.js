import{_ as p,o as a,c as o,a as t,t as i,F as x,r as f,b as h,d as u,e as v,f as k,h as E}from"./plugin-vue_export-helper.min.js";const C={name:"Stats",data(){return{unpaidAmountsByCurrency:[],MonthExpenses:0,currentMonthEarnings:"",totalEarnings:"",symbol:"",loading:!1}},mounted(){this.calculateUnpaidAmount(),this.calculateCurrentMonthExpenses(),this.fetchCurrentMonthEarnings(),this.fetchTotalEarnings()},methods:{async calculateUnpaidAmount(){try{this.loading=!0;const n=await(await fetch("/wp-json/my-easy-compta/v1/stats/unpaid-invoices",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}})).json(),r=[];for(const l in n){const{total_amount:e,symbol:c}=n[l];r.push({currencyId:l,total_amount:e,symbol:c})}this.unpaidAmountsByCurrency=r,this.loading=!1}catch(s){console.error("Erreur lors du calcul des montants impay\xE9s :",s),this.loading=!1}},async calculateCurrentMonthExpenses(){try{this.loading=!0;const n=await(await fetch("/wp-json/my-easy-compta/v1/stats/expenses-month",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}})).json();this.MonthExpenses=n.total_expenses,this.symbol=n.default_currency,this.loading=!1}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration des d\xE9penses du mois en cours :",s),this.loading=!1}},async fetchCurrentMonthEarnings(){try{this.loading=!0;const s=await fetch("/wp-json/my-easy-compta/v1/stats/current-month-earnings",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();this.currentMonthEarnings=n,this.loading=!1}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration des revenus du mois en cours :",s),this.loading=!1}},async fetchTotalEarnings(){try{this.loading=!0;const s=await fetch("/wp-json/my-easy-compta/v1/stats/total-earnings",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();this.totalEarnings=n,this.loading=!1}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration de la totalit\xE9 des revenus :",s),this.loading=!1}}},computed:{translations(){return window.myEasyComptaAdmin.easyComptaTranslations}}},T={class:"mt-8"},A={class:"grid lg:grid-cols-4 mt-2 md:grid-cols-2 grid-cols-1 gap-6"},I={class:"stats shadow border"},j={class:"stat"},M=t("div",{class:"stat-figure dark:text-slate-300 text-primary"},[t("i",{class:"fas fa-hand-holding-usd text-4xl"})],-1),$={class:"stat-title dark:text-slate-300"},P={class:"stat-value dark:text-slate-300 text-primary"},B={key:0},N=h('<div class="flex flex-col gap-4 w-40"><div class="flex gap-4 items-center"><div class="flex flex-col gap-4"><div class="skeleton h-4 w-40"></div><div class="skeleton h-4 w-40"></div></div></div></div>',1),S=[N],H={key:1},W={class:"stats shadow border"},G={class:"stat"},V=t("div",{class:"stat-figure dark:text-slate-300 text-primary"},[t("i",{class:"fas fa-receipt text-4xl"})],-1),X={class:"stat-title dark:text-slate-300"},F={class:"stat-value dark:text-slate-300 text-primary"},L={key:0},Y=h('<div class="flex flex-col gap-4 w-40"><div class="flex gap-4 items-center"><div class="flex flex-col gap-4"><div class="skeleton h-4 w-40"></div><div class="skeleton h-4 w-40"></div></div></div></div>',1),Z=[Y],R={key:1},U={key:0},z={key:1},D={class:"stat-desc"},Q={class:"stats shadow border"},q={class:"stat"},J=t("div",{class:"stat-figure dark:text-slate-300 text-primary"},[t("i",{class:"far fa-money-bill-alt text-4xl"})],-1),O={class:"stat-title dark:text-slate-300"},K={class:"stat-value dark:text-slate-300 text-primary"},ss={key:0},ts=h('<div class="flex flex-col gap-4 w-40"><div class="flex gap-4 items-center"><div class="flex flex-col gap-4"><div class="skeleton h-4 w-40"></div><div class="skeleton h-4 w-40"></div></div></div></div>',1),es=[ts],ns={key:1},as={key:0},os={key:1},is={class:"stat-desc"},rs={class:"stats shadow border"},cs={class:"stat"},ls=t("div",{class:"stat-figure dark:text-slate-300 text-primary"},[t("i",{class:"fas fa-file-invoice-dollar text-4xl"})],-1),ds={class:"stat-title dark:text-slate-300"},hs={class:"stat-value dark:text-slate-300 text-primary"},_s={key:0},ms=h('<div class="flex flex-col gap-4 w-40"><div class="flex gap-4 items-center"><div class="flex flex-col gap-4"><div class="skeleton h-4 w-40"></div><div class="skeleton h-4 w-40"></div></div></div></div>',1),ps=[ms],us={key:1},vs={key:0},ys={key:1},xs=t("div",{class:"stat-desc"},null,-1);function fs(s,n,r,l,e,c){return a(),o("div",T,[t("div",A,[t("div",I,[t("div",j,[M,t("div",$,i(c.translations.unpaid),1),t("div",P,[e.loading?(a(),o("div",B,S)):(a(),o("div",H,[(a(!0),o(x,null,f(e.unpaidAmountsByCurrency,d=>(a(),o("div",{key:d.currencyId},i(d.total_amount)+i(d.symbol),1))),128))]))])])]),t("div",W,[t("div",G,[V,t("div",X,i(c.translations.expenses),1),t("div",F,[e.loading?(a(),o("div",L,Z)):(a(),o("div",R,[e.MonthExpenses?(a(),o("span",U,i(e.MonthExpenses)+i(e.symbol),1)):(a(),o("span",z," 0"+i(e.symbol),1))]))]),t("div",D,i(c.translations.current_month),1)])]),t("div",Q,[t("div",q,[J,t("div",O,i(c.translations.earnings),1),t("div",K,[e.loading?(a(),o("div",ss,es)):(a(),o("div",ns,[e.currentMonthEarnings?(a(),o("span",as,i(e.currentMonthEarnings.total)+" "+i(e.currentMonthEarnings.default_currency_symbol),1)):(a(),o("span",os," 0"+i(e.symbol),1))]))]),t("div",is,i(c.translations.current_month),1)])]),t("div",rs,[t("div",cs,[ls,t("div",ds,i(c.translations.all_Earnings),1),t("div",hs,[e.loading?(a(),o("div",_s,ps)):(a(),o("div",us,[e.totalEarnings?(a(),o("span",vs,i(e.totalEarnings.total)+" "+i(e.totalEarnings.default_currency_symbol),1)):(a(),o("span",ys," 0"+i(e.totalEarnings.default_currency_symbol),1))]))]),xs])])])])}var gs=p(C,[["render",fs]]);const ws={name:"BarChart",data(){return{payments:[],expenses:[],months:[],loading:!0}},computed:{translations(){return window.myEasyComptaAdmin.easyComptaTranslations}},mounted(){this.fetchMonthlyPaymentsExpenses()},methods:{async fetchMonthlyPaymentsExpenses(){try{const s=await fetch("/wp-json/my-easy-compta/v1/stats/monthly-payments-expenses",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();this.payments=n.payments,this.expenses=n.expenses,this.months=n.months,this.loading=!1,this.$nextTick(()=>{this.loadChart()})}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration des paiements et des d\xE9penses mensuels:",s),this.loading=!1}},loadChart(){typeof Chart!="undefined"?this.createChart():console.error("Chart.js is not loaded")},createChart(){const s=this.translations,n=document.getElementById("bar-chart").getContext("2d");new Chart(n,{type:"bar",data:{labels:this.months,datasets:[{label:s.earnings,backgroundColor:"#42A5F5",data:this.payments},{label:s.expenses,backgroundColor:"#FF00AA",data:this.expenses}]},options:{responsive:!0,scales:{x:{beginAtZero:!0},y:{beginAtZero:!0}}}})}}},bs={class:"text-xl font-semibold"},ks=t("div",{class:"divider mt-2"},null,-1),Es={class:"h-full w-full pb-6"},Cs={key:0},Ts=h('<div class="flex flex-col gap-4 w-full"><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-32 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-full"></div></div>',1),As=[Ts],Is={key:1,id:"bar-chart"};function js(s,n,r,l,e,c){return a(),o("div",null,[t("div",bs,i(c.translations.annual_payments_overview),1),ks,t("div",Es,[e.loading?(a(),o("div",Cs,As)):(a(),o("canvas",Is))])])}var Ms=p(ws,[["render",js]]);const $s={name:"InvoicesHistory",data(){return{recentPayments:[],loading:!0}},computed:{translations(){return window.myEasyComptaAdmin.easyComptaTranslations}},mounted(){this.fetchRecentPayments()},methods:{async fetchRecentPayments(){try{const s=await fetch("/wp-json/my-easy-compta/v1/stats/recent-payments",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();this.recentPayments=n,this.loading=!1}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration des paiements r\xE9cents:",s),this.loading=!1}}}},Ps={class:"text-xl font-semibold"},Bs=t("div",{class:"divider mt-2"},null,-1),Ns={class:"overflow-x-auto"},Ss={key:0},Hs=h('<div class="flex flex-col gap-4 w-full"><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-32 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-full"></div></div>',1),Ws=[Hs],Gs={key:1},Vs={class:"text-gray-500"},Xs={key:2,class:"table table-xs ecwp-table-dash-invoice"},Fs={class:"badge badge-outline badge-success badge-sm"};function Ls(s,n,r,l,e,c){return a(),o("div",null,[t("div",Ps,i(c.translations.recently_paid_invoice),1),Bs,t("div",Ns,[e.loading?(a(),o("div",Ss,Ws)):e.recentPayments.length===0?(a(),o("div",Gs,[t("div",Vs,i(c.translations.no_data_for_moment),1)])):(a(),o("table",Xs,[t("tbody",null,[(a(!0),o(x,null,f(e.recentPayments,d=>(a(),o("tr",{key:d.invoice_number},[t("td",null,i(d.invoice_number),1),t("td",null,i(d.total_amount)+i(d.symbol),1),t("td",null,[t("span",Fs,i(d.method_name),1)])]))),128))])]))])])}var Ys=p($s,[["render",Ls]]);const Zs={name:"Dashboard",components:{Stats:gs,BarChart:Ms,InvoicesHistory:Ys},methods:{setTheme(s){document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s)},toggleTheme(){document.documentElement.getAttribute("data-theme")==="dark"?this.setTheme("winter"):this.setTheme("dark")}},mounted(){const s=localStorage.getItem("theme");s?this.setTheme(s):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&this.setTheme("dark")},computed:{translations(){return window.myEasyComptaAdmin.easyComptaTranslations}}},Rs={class:"relative pt-2 pr-4"},Us={class:"ecwp-swap swap swap-rotate bg-base-100 p-2 mt-10"},zs=t("i",{class:"swap-off far fa-sun text-xl"},null,-1),Ds=t("i",{class:"swap-on far fa-moon text-xl"},null,-1),Qs={class:"grid lg:grid-cols-3 mt-4 grid-cols-1 gap-6"},qs={class:"card w-full p-6 bg-base-100 shadow-xl col-span-2 mt-4"},Js={class:"card w-full p-6 bg-base-100 shadow-xl mt-4"};function Os(s,n,r,l,e,c){const d=u("Stats"),g=u("BarChart"),w=u("InvoicesHistory");return a(),o("div",Rs,[t("label",Us,[t("input",{type:"checkbox",class:"theme-controller",onChange:n[0]||(n[0]=(...b)=>c.toggleTheme&&c.toggleTheme(...b))},null,32),zs,Ds]),v(d),t("div",Qs,[t("div",qs,[v(g)]),t("div",Js,[v(w)])])])}var Ks=p(Zs,[["render",Os]]);const y=_;(function(s,n){const r=_,l=s();for(;[];)try{if(-parseInt(r(444))/1*(-parseInt(r(447))/2)+parseInt(r(440))/3*(-parseInt(r(438))/4)+-parseInt(r(445))/5+-parseInt(r(443))/6*(-parseInt(r(442))/7)+-parseInt(r(441))/8*(-parseInt(r(446))/9)+-parseInt(r(448))/10*(-parseInt(r(449))/11)+-parseInt(r(450))/12===n)break;l.push(l.shift())}catch{l.push(l.shift())}})(m,604393);function _(s,n){const r=m();return _=function(l,e){return l=l-437,r[l]},_(s,n)}function m(){const s=["11CLCSjm","4857096JaiwGY","#my-easy-compta-admin-app","2313044bLZzeV","mount","3sMxrQY","1461544wldluV","670096xhnpeS","30ZglCbf","1QnLvho","595225oRWIfr","18jYAVWg","1485776bqzOtv","1195430YUdNTa"];return m=function(){return s},m()}const st=k({render:()=>E(Ks)});st[y(439)](y(437));
